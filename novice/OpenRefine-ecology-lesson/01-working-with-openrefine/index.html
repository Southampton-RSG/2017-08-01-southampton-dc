<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2017-04-05 12:47:24 +0100">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicon-dc.ico" />
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <title>Open Refine for Ecology: Working with OpenRefine</title>
  </head>
  <body>
    <div class="container">
      
<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="http://datacarpentry.org" class="pull-left">
        <img class="navbar-logo" src="../assets/img/dc-icon-black.svg" alt="Data Carpentry logo" />
      </a>
      

      
      <a class="navbar-brand" href="../">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../conduct/">Code of Conduct</a></li>

	
        
        <li><a href="../setup/">Setup</a></li>
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../00-getting-started/">Introduction</a></li>
            
            <li><a href="../01-working-with-openrefine/">Working with OpenRefine</a></li>
            
            <li><a href="../02-filter-exclude-sort/">Filtering and Sorting with OpenRefine</a></li>
            
            <li><a href="../03-numbers/">Examining Numbers in OpenRefine</a></li>
            
            <li><a href="../04-scripts/">Scripts from OpenRefine</a></li>
            
            <li><a href="../05-save-export/">Exporting and Saving Data from OpenRefine</a></li>
            
            <li><a href="../06-resources/">Other Resources in OpenRefine</a></li>
            
          </ul>
        </li>
	

	
	
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference/">Reference</a></li>
            
            <li><a href="../about/">About</a></li>
            
            <li><a href="../discuss/">Discussion</a></li>
            
            <li><a href="../figures/">Figures</a></li>
            
            <li><a href="../guide/">Instructor Notes</a></li>
            
          </ul>
        </li>
	

	
        <li><a href="../license/">License</a></li>
	
	<li><a href="/edit/gh-pages/_episodes/01-working-with-openrefine.md">Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-1">
    <h3>
      
      <a href="../00-getting-started/"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-md-10">
    
    <h3 class="maintitle"><a href="../">Open Refine for Ecology</a></h3>
    <h1 class="maintitle">Working with OpenRefine</h1>
    
  </div>
  <div class="col-md-1">
    <h3>
      
      <a href="../02-filter-exclude-sort/"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 15 min
      <br/>
      <strong>Exercises:</strong> 20 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>Getting started working with OpenRefine</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Create a new OpenRefine project from a CSV file.</p>
</li>
	
	<li><p>Recall what facets are and how they are used to sort and summarize data.</p>
</li>
	
	<li><p>Recall what clustering is and how it is applied to group and edit typos.</p>
</li>
	
	<li><p>Manipulate data using previous steps with undo/redo.</p>
</li>
	
	<li><p>Employ drop-downs to split values from one column into multiple columns.</p>
</li>
	
	<li><p>Employ drop-downs to remove white spaces from cells.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h1 id="lesson">Lesson</h1>

<h2 id="creating-a-project">Creating a Project</h2>

<p>Start the program. (Double-click on the openrefine.exe file (or google-refine.exe if using an older version). Java services will start on your machine, and OpenRefine will open in your Firefox browser).</p>

<p>Launch OpenRefine (see <a href="00-getting-started.html">Getting Started with OpenRefine</a>).</p>

<p>OpenRefine can import a variety of file types, including tab separated (<code class="highlighter-rouge">*.tsv</code>), comma separated (<code class="highlighter-rouge">*.csv</code>), Excel (<code class="highlighter-rouge">*.xls</code>, <code class="highlighter-rouge">*.xlsx</code>), JSON, XML, RDF as XML, Google Spreadsheets. See the <a href="https://github.com/OpenRefine/OpenRefine/wiki/Importers">OpenRefine Importers page</a> for more information.</p>

<p>In this first step, we’ll browse our computer to the sample data file for this lesson. In this case, We modified the <code class="highlighter-rouge">Portal_rodents</code> CSV file, adding several columns: <code class="highlighter-rouge">scientificName</code>, <code class="highlighter-rouge">locality</code>, <code class="highlighter-rouge">county</code>, <code class="highlighter-rouge">state</code>, <code class="highlighter-rouge">country</code> and generating several more columns in the lesson itself (<code class="highlighter-rouge">JSON</code>, <code class="highlighter-rouge">decimalLatitude</code>, <code class="highlighter-rouge">decimalLongitude</code>). Data in <code class="highlighter-rouge">locality</code>, <code class="highlighter-rouge">county</code>, <code class="highlighter-rouge">country</code>, <code class="highlighter-rouge">JSON</code>, <code class="highlighter-rouge">decimalLatitude</code> and <code class="highlighter-rouge">decimalLongitude</code> are contrived and are in no way related to the original dataset.</p>

<p>If you haven’t already, download the data from:<br />
<a href="https://ndownloader.figshare.com/files/7823341">https://ndownloader.figshare.com/files/7823341</a></p>

<p>Once OpenRefine is launched in your browser, the left margin as options to <strong>Create Project</strong>, <strong>Open Project</strong>, or <strong>Import Project</strong>. Here we create a project, which just takes a couple steps:</p>

<ol>
  <li>click <strong>Create Project</strong> to bring you to “Get data from” “<strong>This Computer</strong>”.</li>
  <li>Click <strong>Browse…</strong> and select file <code class="highlighter-rouge">Portal_rodents_19772002_scinameUUIDs.csv</code>. Click <strong>Open</strong> in the browse window to finish selection</li>
  <li>Click <strong>Next»</strong> under the browse button to upload data into OpenRefine.</li>
  <li>OpenRefine gives you a preview - a chance to show you it understood the file. If, for example, your file was really tab-delimited, the preview might look strange, you would choose the correct separator in the box shown and click <strong>Update Preview</strong> (look in bottom panel). If this is the wrong file, click <strong>«Start Over</strong> (look in upper left region).</li>
  <li>If all looks well, click <strong>Create Project»</strong> (look in upper right corner).</li>
</ol>

<p>Note that at step 1, you could upload data in a standard form from a web address by using “Get data from” “<strong>Web Addresses (URLs)</strong>”. However, this won’t work for all URLs.</p>

<h2 id="faceting">Faceting</h2>

<p><em>Exploring data by applying multiple filters</em></p>

<p>OpenRefine supports faceted browsing as a mechanism for</p>

<ul>
  <li>seeing a big picture of your data, and</li>
  <li>filtering down to just the subset of rows that you want to change in bulk.</li>
</ul>

<p>Typically, you create a facet on a particular column. The facet summarizes the cells in that column to give you a big picture on that column, and allows you to filter to some subset of rows for which their cells in that column satisfy some constraint. That’s a bit abstract, so let’s jump into some examples.</p>

<p><a href="https://github.com/OpenRefine/OpenRefine/wiki/Faceting">More on faceting</a></p>

<blockquote>
  <ul>
    <li>Scroll over to the scientificName column.</li>
    <li>Click the down arrow and choose &gt; Facet &gt; Text facet.</li>
    <li>In the left margin, you’ll see a box containing every unique, distinct value in the scientificName column 
and how many times that value occurs in the column.</li>
    <li>Try sorting this facet by name and by count. Do you notice any problems with the data? What are they?</li>
    <li>Hover the mouse over one of the names in the Facet list. You should see that you have an “edit” function available. 
You could use this to fix an error immediately, and OpenRefine will ask if you want 
to make the same correction to every value it finds like that one (or not). But OpenRefine offers 
even better ways to find and fix these errors, which we’ll use instead.</li>
  </ul>
</blockquote>

<blockquote class="challenge">
  <h2 id="exercise">Exercise</h2>

  <p>Using faceting, find out how many years are represented in the census.</p>

  <p>Is the column formatted as Number, Date, or Text? How does changing the format change the faceting display?</p>

  <p>Which years have the most and least observations?</p>
</blockquote>

<h2 id="cluster">Cluster</h2>

<p>In OpenRefine, clustering means “finding groups of different values that might be alternative representations of the same thing”. For example, the two strings “New York” and “new york” are very likely to refer to the same concept and just have capitalization differences. Likewise, “Gödel” and “Godel” probably refer to the same person. Clustering is a very powerful tool for cleaning datasets which contain misspelled or mistyped entries. OpenRefine has several clustering algorithms built in. Experiment with them, and learn more about these algorithms and how they work.</p>

<blockquote>
  <ul>
    <li>In the scientificName Text Facet we created in the step above, click the <em>Cluster</em> button.</li>
    <li>In the resulting pop-up window, you can change the Method and the Keying Function. Try different combinations to 
see what different mergers of values are suggested.</li>
    <li>Select the <em>key collision</em> method and <em>metaphone3</em> keying function. It should identify three clusters. 
Click the <em>Merge?</em> box beside each, then click <em>Merge Selected and Recluster</em> to 
apply the corrections to the dataset.</li>
    <li>Try selecting different Methods and Keying Functions again, to see what new mergers are suggested. You may find there are 
still improvements that can be made, but don’t Merge again; just Close when you’re done.  We’ll now 
see other operations that will help us detect and correct the remaining problems, 
and that have more general uses besides.</li>
  </ul>
</blockquote>

<p><a href="https://github.com/OpenRefine/OpenRefine/wiki/Clustering-In-Depth">More on clustering</a></p>

<h2 id="split">Split</h2>

<p>If data in a column needs to be split into multiple columns, and the parts are separated by a common separator (say a comma, or a space), you can use that separator to divide up the bits into their own columns.</p>

<blockquote>
  <ul>
    <li>Let us suppose we want to split the scientificName column into separate colums for genus and for species.</li>
    <li>Go to the drop-down tab at the top of the scientificName column. Choose Edit Column &gt; Split into several columns.</li>
    <li>In the pop-up, in the Separator box, replace the comma with a space.</li>
    <li>Remove the check in the box that says “Remove the column”.</li>
    <li>Click “OK”. You’ll get some new columns called <em>scientificName 1</em>, <em>scientificName 2</em>, and so on.</li>
    <li>Notice that in some cases <em>scientificName 1</em> and <em>scientificName 2</em> are empty. Why is this? What do you think we 
should do about it?</li>
  </ul>
</blockquote>

<blockquote class="challenge">
  <h2 id="exercise-1">Exercise</h2>

  <p>Try to change the name of the second new column to “species”. How can you correct the problem you encounter?</p>
</blockquote>

<h2 id="undo--redo">Undo / Redo</h2>

<p>It’s common while exploring and cleaning a dataset to discover after you’ve made a change that you really should have done something else first. OpenRefine provides Undo and Redo operations to make this easy.</p>

<blockquote>
  <ul>
    <li>Click where it says Undo / Redo on the left side of the screen. All the changes you have made so far are listed here.</li>
    <li>Click on the step that you want to go back to, in this case the previous step. The added columns will disappear.</li>
    <li>Notice that you can still click on the last step and make the columns reappear, and back, and forth.</li>
    <li>Leave the dataset in the state in which the scientificNames were clustered, but not yet split.</li>
  </ul>
</blockquote>

<h2 id="trim-leading-and-trailing-whitespace">Trim Leading and Trailing Whitespace</h2>

<p>Strings with spaces at the beginning or end are particularly hard for we humans to tell from strings without, but the blank characters will make a difference to the computer. We usually want to remove these. OpenRefine provides a tool to remove blank characters from the beginning and end of any entries that have them.</p>

<blockquote>
  <ul>
    <li>In the header for the column <em>scientificName</em>, choose Edit cells &gt; Common transforms &gt; Trim leading and trailing whitespace.</li>
    <li>Notice that the Split step has now disappeared from the Undo / Redo pane on the left.</li>
    <li>Perform the same Split operation on scientificName that you undid earlier. This time you should only get two new columns.</li>
  </ul>
</blockquote>



<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Faceting and clustering approaches can identify errors or outliers in data.</p>
</li>
    
  </ul>
</blockquote>


<div class="row">
  <div class="col-md-1">
    <h3>
      
      <a href="../00-getting-started/"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-md-10">
    
  </div>
  <div class="col-md-1">
    <h3>
      
      <a href="../02-filter-exclude-sort/"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      
<footer>
  <div class="row">
    <div class="col-md-6" align="left">
      <h4>
	Copyright &copy; 2016–2017
	
	<a href="http://datacarpentry.org">Data Carpentry</a>
	
      </h4>
    </div>
    <div class="col-md-6" align="right">
      <h4>
	
	<a href="/edit/gh-pages/_episodes/01-working-with-openrefine.md">Edit on GitHub</a>
	
	/
	<a href="/blob/gh-pages/CONTRIBUTING.md">Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob/gh-pages/CITATION">Cite</a>
	/
	<a href="mailto:lessons@datacarpentry.org">Contact</a>
      </h4>
    </div>
  </div>
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
