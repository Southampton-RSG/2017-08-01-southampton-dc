<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2017-04-05 12:38:18 +0100">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicon-dc.ico" />
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <title>Data Organization in Spreadsheets: Formatting problems</title>
  </head>
  <body>
    <div class="container">
      
<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="http://datacarpentry.org" class="pull-left">
        <img class="navbar-logo" src="../assets/img/dc-icon-black.svg" alt="Data Carpentry logo" />
      </a>
      

      
      <a class="navbar-brand" href="../">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../conduct/">Code of Conduct</a></li>

	
        
        <li><a href="../setup/">Setup</a></li>
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../00-intro/">Introduction</a></li>
            
            <li><a href="../01-format-data/">Formatting data tables in Spreadsheets</a></li>
            
            <li><a href="../02-common-mistakes/">Formatting problems</a></li>
            
            <li><a href="../03-dates-as-data/">Dates as data</a></li>
            
            <li><a href="../04-quality-control/">Quality control</a></li>
            
            <li><a href="../05-exporting-data/">Exporting data</a></li>
            
          </ul>
        </li>
	

	
	
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference/">Reference</a></li>
            
            <li><a href="../extras/06-data-formats-caveats.html">Caveats of popular data and file formats</a></li>
            
            <li><a href="../about/">About</a></li>
            
            <li><a href="../discuss/">Discussion</a></li>
            
            <li><a href="../figures/">Figures</a></li>
            
            <li><a href="../guide/">Instructor Notes</a></li>
            
          </ul>
        </li>
	

	
        <li><a href="../license/">License</a></li>
	
	<li><a href="/edit/gh-pages/_episodes/02-common-mistakes.md">Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>


<div class="row">
  <div class="col-md-1">
    <h3>
      
      <a href="../01-format-data/"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-md-10">
    
    <h3 class="maintitle"><a href="../">Data Organization in Spreadsheets</a></h3>
    <h1 class="maintitle">Formatting problems</h1>
    
  </div>
  <div class="col-md-1">
    <h3>
      
      <a href="../03-dates-as-data/"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 20 min
      <br/>
      <strong>Exercises:</strong> 0 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>Some of the common formatting challenges and how to avoid them</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Recognize and resolve common spreadsheet formatting problems.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<p>Authors:<strong>Christie Bahlai</strong>, <strong>Aleksandra Pawlik</strong><br />
Contributors: <strong>Jennifer Bryan</strong>, <strong>Alexander Duryee</strong>, <strong>Jeffrey Hollister</strong>, <strong>Daisie Huang</strong>, <strong>Owen Jones</strong>, and <strong>Ben Marwick</strong></p>

<h2 id="common-spreadsheet-errors">Common Spreadsheet Errors</h2>

<ul>
  <li><a href="#tables">Multiple tables</a></li>
  <li><a href="#tabs">Multiple tabs</a></li>
  <li><a href="#zeros">Not filling in zeros</a></li>
  <li><a href="#null">Using bad null values</a></li>
  <li><a href="#formatting">Using formatting to convey information</a></li>
  <li><a href="#formatting_pretty">Using formatting to make the data sheet look pretty</a></li>
  <li><a href="#units">Placing comments or units in cells</a></li>
  <li><a href="#info">More than one piece of information in a cell</a></li>
  <li><a href="#field_name">Field name problems</a></li>
  <li><a href="#special">Special characters in data</a></li>
  <li><a href="#metadata">Inclusion of metadata in data table</a></li>
  <li><a href="../03-dates-as-data/">Date formatting</a></li>
</ul>

<h2 id="-multiple-tables"><a name="tables"></a> Multiple tables</h2>

<p>A common strategy is creating multiple data tables within
one spreadsheet. This confuses the computer, so don’t do this!
When you create multiple tables within one
spreadsheet, you’re drawing false associations between things for the computer,
which sees each row as an observation. You’re also potentially using the same
field name in multiple places, which will make it harder to clean your data up
into a usable form. The example below depicts the problem:</p>

<p><img src="../fig/2_datasheet_example.jpg" alt="multiple tabs" /></p>

<h2 id="-multiple-tabs"><a name="tabs"></a> Multiple tabs</h2>

<p>But what about workbook tabs? That seems like an easy way to organize data, right? Well, yes and no. When you create extra tabs, you fail to allow the computer to see connections in the data that are there (you have to introduce spreadsheet application-specific functions or scripting to ensure this connection). Say, for instance, you make a separate tab for each day you take a measurement.</p>

<p>This is bad practice for two reasons:
1) you are more likely to accidentally add inconsistencies to your data if each time you take a measurement, you start recording data in a new tab, and
2) even if you manage to prevent all inconsistencies from creeping in, you will add an extra step for yourself before you analyze the data because you will have to combine these data into a single datatable. You will have to explicitly tell the computer how to combine tabs - and if the tabs are inconsistently formatted, you might even have to do it by hand!</p>

<p>The next time you’re entering data, and you go to create another tab or table, ask yourself “Self, could I avoid adding this tab by adding another column to my original spreadsheet?”</p>

<p>Your data sheet might get very long over the course of the experiment. This makes it harder to enter data if you can’t see your headers at the top of the spreadsheet. But don’t repeat headers. These can easily get mixed into the data, leading to problems down the road.</p>

<p>Instead you can freeze the column headers.</p>

<p><a href="https://support.office.com/en-ca/article/Freeze-column-headings-for-easy-scrolling-57ccce0c-cf85-4725-9579-c5d13106ca6a">Documentation on how to freeze column headers</a></p>

<h2 id="-not-filling-in-zeros"><a name="zeros"></a> Not filling in zeros</h2>

<p>It might be that when you’re measuring something, it’s
usually a zero, say the number of times a rabbit
is observed in the survey. Why bother
writing in the number zero in that column, when it’s mostly zeros?</p>

<p>However, there’s a difference between a zero and a blank cell in a spreadsheet. To the computer, a zero is actually data. You measured or counted it. A blank cell means that it wasn’t measured and the computer will interpret it as a null value.</p>

<p>The spreadsheets or statistical programs will likely mis-interpret blank cells that are meant to be zero. This is equivalent to leaving out data. Zero observations are real data! Leaving zero data blank is not good in a written lab notebook, but never okay when you move your data into a digital format.</p>

<h2 id="-using-bad-null-values"><a name="null"></a> Using bad null values</h2>
<p><strong>Example</strong>: using -999 or other numerical values (or zero).</p>

<p><strong>Solution</strong>: Many statistical programs will not recognize that numeric values of null are indeed null. It will depend on the final application of your data and how you intend to analyse it, but it is essential to use a clearly defined and consistent null indicator. Blanks (most applications) and NA (for R) are good choices.</p>

<p>From White et al, 2013, <a href="http://library.queensu.ca/ojs/index.php/IEE/article/view/4608/4898">Nine simple ways to make it easier to (re)use your data.</a> Ideas in Ecology and Evolution:</p>

<p><img src="../fig/3_white_table_1.jpg" alt="White et al." /></p>

<h2 id="-using-formatting-to-convey-information"><a name="formatting"></a> Using formatting to convey information</h2>

<p><strong>Example</strong>: highlighting cells, rows or columns that should be excluded from an analysis, leaving blank rows to indicate separations in data.</p>

<p><img src="../fig/formatting.png" alt="formatting" /></p>

<p><strong>Solution</strong>: create a new field to encode which data should be excluded.</p>

<p><img src="../fig/good_formatting.png" alt="good formatting" /></p>

<h2 id="-using-formatting-to-make-the-data-sheet-look-pretty"><a name="formatting_pretty"></a> Using formatting to make the data sheet look pretty</h2>

<p><strong>Example</strong>: merging cells.</p>

<p><strong>Solution</strong>: If you’re not careful, formatting a worksheet to be more aesthetically pleasing can compromise your computer’s ability to see associations in the data. Merged cells will make your data unreadable by statistics software. Consider restructuring your data in such a way that you will not need to merge cells to organize your data.</p>

<h2 id="-placing-comments-or-units-in-cells"><a name="units"></a> Placing comments or units in cells</h2>

<p><strong>Example</strong>: Your data was collected, in part, by a summer student who you later found out was mis-identifying some of your species, some of the time. You want a way to note these data are suspect.</p>

<p><strong>Solution</strong>: Most analysis software can’t see Excel or LibreOffice comments, and would be confused by comments placed within your data cells. As described above for formatting, create another field if you need to add notes to cells. Similarly, don’t include units in cells: ideally, all the measurements you place in one column should be in the same unit, but if for some reason they aren’t, create another field and specify the units the cell is in.</p>

<h2 id="-more-than-one-piece-of-information-in-a-cell"><a name="info"></a> More than one piece of information in a cell</h2>

<p><strong>Example</strong>: You find one male, and one female of the same species. You enter this as 1M, 1F.</p>

<p><strong>Solution</strong>: Never include more than one piece of information in a cell. If you need both these measurements, design your data sheet to include this information.</p>

<h2 id="-field-name-problems"><a name="field_name"></a> Field name problems</h2>
<p>Choose descriptive field names, but be careful not to include spaces, numbers, or special characters of any kind. Spaces can be misinterpreted by parsers that use whitespace as delimiters and some programs don’t like field names that are text strings that start with numbers.
Underscores (<code class="highlighter-rouge">_</code>) are a good alternative to spaces. Consider writing names in camel case (like this: ExampleFileName) to improve readability. Remember that abbreviations that make sense at the moment may not be so obvious in 6 months, but don’t overdo it with names that are excessively long. Including the units in the field names avoids confusion and enables others to readily interpret your fields.</p>

<p><strong>Examples</strong></p>

<table align="left" style="width =50%; border: 1px solid black;">
<tr>
	<td> <b>Good Name</b></td> <br />
	<td> <b>Good Alternative </b> </td><br />
	<td> <b>Avoid </b></td><br />
</tr>
<tr>
	<td> Max_temp_C</td>
	<td> MaxTemp </td>
	<td> Maximum Temp (°C) </td>
</tr>
<tr>
	<td> Precipitation_mm</td>
	<td> Precipitation</td>
	<td> precmm </td>
</tr>	
<tr>
	<td> Mean_year_growth</td>
	<td> MeanYearGrowth </td>
	<td> Mean growth/year</td>	
</tr>	
<tr>
	<td> sex </td>
	<td> sex </td>	
	<td> M/F </td>
</tr>
<tr>	
	<td> weight </td>
	<td> weight </td>	
	<td> w.</td>	
</tr>
<tr>	
	<td> cell_type </td>
	<td> CellType </td>
	<td> Cell Type </td>
</tr>
<tr>
	<td> Observation_01 </td>
	<td> first_observation</td>
	<td> 1st Obs</td>
</tr>
</table>

<h2 id="-special-characters-in-data"><a name="special"></a> Special characters in data</h2>

<p><strong>Example</strong>: You treat your spreadsheet program as a word processor when writing notes, for example copying data directly from Word or other applications.</p>

<p><strong>Solution</strong>: This is a common strategy. For example, when writing longer text in a cell, people often include line breaks, em-dashes, etc in their spreadsheet.  Also, when copying data in from applications such as Word, formatting and fancy non-standard characters (such as left- and right-aligned quotation marks) are included.  When exporting this data into a coding/statistical environment or into a relational database, dangerous things may occur, such as lines being cut in half and encoding errors being thrown.</p>

<p>General best practice is to avoid adding characters such as newlines, tabs, and vertical tabs.  In other words, treat a text cell as if it were a simple web form that can only contain text and spaces.</p>

<h2 id="-inclusion-of-metadata-in-data-table"><a name="metadata"></a> Inclusion of metadata in data table</h2>

<p><strong>Example</strong>: You add a legend at the top or bottom of your data table explaining column meaning, units, exceptions, etc.</p>

<p><strong>Solution</strong>: While recording data about your data (“metadata”) is essential, this information should not be contained in the data file itself. Unlike a table in a paper or a supplemental file, metadata (in the form of legends) should not be included in a data file since this information is not data, and including it can disrupt how computer programs interpret your data file. Rather, metadata should be stored as a separate file in the same directory as your data file, preferably in plain text format with a name that clearly associates it with your data file. Because metadata files are free text format, they also allow you to encode comments, units, information about how null values are encoded, etc. that are important to document but can disrupt the formatting of your data file.</p>


<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Avoid using multiple tables within one spreadsheet.</p>
</li>
    
    <li><p>Avoid spreading data across multiple tabs (but do use a new tab to record data cleaning or manipulations).</p>
</li>
    
    <li><p>Record zeros as zeros.</p>
</li>
    
    <li><p>Use an appropriate null value to record missing data.</p>
</li>
    
    <li><p>Don’t use formatting to convey information or to make your spreadsheet look pretty.</p>
</li>
    
    <li><p>Place comments in a separate column.</p>
</li>
    
    <li><p>Record units in column headers.</p>
</li>
    
    <li><p>Include only one piece of information in a cell.</p>
</li>
    
    <li><p>Avoid spaces, numbers and special characters in column headers.</p>
</li>
    
    <li><p>Avoid special characters in your data.</p>
</li>
    
    <li><p>Record metadata in a separate plain text file.</p>
</li>
    
  </ul>
</blockquote>


<div class="row">
  <div class="col-md-1">
    <h3>
      
      <a href="../01-format-data/"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-md-10">
    
  </div>
  <div class="col-md-1">
    <h3>
      
      <a href="../03-dates-as-data/"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      
<footer>
  <div class="row">
    <div class="col-md-6" align="left">
      <h4>
	Copyright &copy; 2016–2017
	
	<a href="http://datacarpentry.org">Data Carpentry</a>
	
      </h4>
    </div>
    <div class="col-md-6" align="right">
      <h4>
	
	<a href="/edit/gh-pages/_episodes/02-common-mistakes.md">Edit on GitHub</a>
	
	/
	<a href="/blob/gh-pages/CONTRIBUTING.md">Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob/gh-pages/CITATION">Cite</a>
	/
	<a href="mailto:lessons@datacarpentry.org">Contact</a>
      </h4>
    </div>
  </div>
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
